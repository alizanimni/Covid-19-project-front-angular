import { NgIconPostProcessorToken, NgIconPreProcessorToken, createFeature, } from './features';
function preprocessIcon(icon) {
    // rename all style attributes to data-style to avoid being blocked by the CSP
    return icon.replace(/style\s*=/g, 'data-style=');
}
function postprocessIcon(element) {
    // find all elements with a data-style attribute and get the styles from it
    // and apply them to the element using the style property and remove the data-style attribute
    const elements = element.querySelectorAll('[data-style]');
    for (const element of Array.from(elements)) {
        const styles = element.getAttribute('data-style');
        styles?.split(';').forEach(style => {
            const [property, value] = style.split(':');
            element.style[property.trim()] = value.trim();
        });
        element.removeAttribute('data-style');
    }
}
/**
 * Process icons in a way that is compliant with the content security policy
 */
export function withContentSecurityPolicy() {
    return createFeature(0 /* NgIconFeatureKind.ContentSecurityPolicyFeature */, [
        { provide: NgIconPreProcessorToken, useValue: preprocessIcon },
        { provide: NgIconPostProcessorToken, useValue: postprocessIcon },
    ]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3NwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvY29yZS9zcmMvbGliL3Byb3ZpZGVycy9mZWF0dXJlcy9jc3AudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUdMLHdCQUF3QixFQUN4Qix1QkFBdUIsRUFDdkIsYUFBYSxHQUNkLE1BQU0sWUFBWSxDQUFDO0FBRXBCLFNBQVMsY0FBYyxDQUFDLElBQVk7SUFDbEMsOEVBQThFO0lBQzlFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDbkQsQ0FBQztBQUVELFNBQVMsZUFBZSxDQUFDLE9BQW9CO0lBQzNDLDJFQUEyRTtJQUMzRSw2RkFBNkY7SUFDN0YsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFjLGNBQWMsQ0FBQyxDQUFDO0lBRXZFLEtBQUssTUFBTSxPQUFPLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1FBQzNDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFbEQsTUFBTSxFQUFFLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDakMsTUFBTSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzNDLE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksRUFBUyxDQUFDLEdBQUcsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3ZELENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN4QyxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxVQUFVLHlCQUF5QjtJQUN2QyxPQUFPLGFBQWEseURBQWlEO1FBQ25FLEVBQUUsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQUU7UUFDOUQsRUFBRSxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLGVBQWUsRUFBRTtLQUNqRSxDQUFDLENBQUM7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29udGVudFNlY3VyaXR5UG9saWN5RmVhdHVyZSxcbiAgTmdJY29uRmVhdHVyZUtpbmQsXG4gIE5nSWNvblBvc3RQcm9jZXNzb3JUb2tlbixcbiAgTmdJY29uUHJlUHJvY2Vzc29yVG9rZW4sXG4gIGNyZWF0ZUZlYXR1cmUsXG59IGZyb20gJy4vZmVhdHVyZXMnO1xuXG5mdW5jdGlvbiBwcmVwcm9jZXNzSWNvbihpY29uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAvLyByZW5hbWUgYWxsIHN0eWxlIGF0dHJpYnV0ZXMgdG8gZGF0YS1zdHlsZSB0byBhdm9pZCBiZWluZyBibG9ja2VkIGJ5IHRoZSBDU1BcbiAgcmV0dXJuIGljb24ucmVwbGFjZSgvc3R5bGVcXHMqPS9nLCAnZGF0YS1zdHlsZT0nKTtcbn1cblxuZnVuY3Rpb24gcG9zdHByb2Nlc3NJY29uKGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gIC8vIGZpbmQgYWxsIGVsZW1lbnRzIHdpdGggYSBkYXRhLXN0eWxlIGF0dHJpYnV0ZSBhbmQgZ2V0IHRoZSBzdHlsZXMgZnJvbSBpdFxuICAvLyBhbmQgYXBwbHkgdGhlbSB0byB0aGUgZWxlbWVudCB1c2luZyB0aGUgc3R5bGUgcHJvcGVydHkgYW5kIHJlbW92ZSB0aGUgZGF0YS1zdHlsZSBhdHRyaWJ1dGVcbiAgY29uc3QgZWxlbWVudHMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTEVsZW1lbnQ+KCdbZGF0YS1zdHlsZV0nKTtcblxuICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgQXJyYXkuZnJvbShlbGVtZW50cykpIHtcbiAgICBjb25zdCBzdHlsZXMgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zdHlsZScpO1xuXG4gICAgc3R5bGVzPy5zcGxpdCgnOycpLmZvckVhY2goc3R5bGUgPT4ge1xuICAgICAgY29uc3QgW3Byb3BlcnR5LCB2YWx1ZV0gPSBzdHlsZS5zcGxpdCgnOicpO1xuICAgICAgZWxlbWVudC5zdHlsZVtwcm9wZXJ0eS50cmltKCkgYXMgYW55XSA9IHZhbHVlLnRyaW0oKTtcbiAgICB9KTtcblxuICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXN0eWxlJyk7XG4gIH1cbn1cblxuLyoqXG4gKiBQcm9jZXNzIGljb25zIGluIGEgd2F5IHRoYXQgaXMgY29tcGxpYW50IHdpdGggdGhlIGNvbnRlbnQgc2VjdXJpdHkgcG9saWN5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRoQ29udGVudFNlY3VyaXR5UG9saWN5KCk6IENvbnRlbnRTZWN1cml0eVBvbGljeUZlYXR1cmUge1xuICByZXR1cm4gY3JlYXRlRmVhdHVyZShOZ0ljb25GZWF0dXJlS2luZC5Db250ZW50U2VjdXJpdHlQb2xpY3lGZWF0dXJlLCBbXG4gICAgeyBwcm92aWRlOiBOZ0ljb25QcmVQcm9jZXNzb3JUb2tlbiwgdXNlVmFsdWU6IHByZXByb2Nlc3NJY29uIH0sXG4gICAgeyBwcm92aWRlOiBOZ0ljb25Qb3N0UHJvY2Vzc29yVG9rZW4sIHVzZVZhbHVlOiBwb3N0cHJvY2Vzc0ljb24gfSxcbiAgXSk7XG59XG4iXX0=